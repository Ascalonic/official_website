<!DOCTYPE html><html><head> <meta charset="utf-8"/> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Products Editor</title> <meta name="viewport" content="width=device-width, initial-scale=1"> <style>.sidenav,.toolbar{position:fixed;left:0;top:0;display:flex}.btn-outline:focus,.toolbar-textbox:focus{outline-style:none}.container,.row,.sidenav,.toolbar{display:flex}*,body{font-family:'Segoe UI'}body{background-color:#f8f9fa}.toolbar{background-color:#3367d6;color:#fff;min-height:56px;z-index:2;align-items:center;direction:ltr;font-size:13px;width:100%;margin:0;-webkit-box-shadow:0 5px 14px -5px rgba(0,0,0,.75);-moz-box-shadow:0 5px 14px -5px rgba(0,0,0,.75);box-shadow:0 5px 14px -5px rgba(0,0,0,.75)}.toolbar-textbox{background-color:#2850a7;color:#fff;border-style:none;height:24px;padding-top:7px;padding-left:7px;padding-right:7px}.card,.sidenav{background-color:#fff}.sidenav{z-index:1000;flex-flow:column;width:220px;-webkit-box-shadow:3px 0 10px -1px rgba(0,0,0,.75);-moz-box-shadow:3px 0 10px -1px rgba(0,0,0,.75);box-shadow:3px 0 10px -1px rgba(0,0,0,.75);height:100%}.fullwidth,.row{width:100%}.sidenav-item{padding:5px;text-align:center;color:#606060;font-weight:600}.sidenav-item:hover{background-color:#eee;cursor:pointer}.sidenav-item:active{background-color:#ddd}.fadeIn{opacity:0;-moz-transition:opacity 1.5s;-webkit-transition:opacity 1.5s;-o-transition:opacity 1.5s;transition:opacity 1.5s}.sidenav-overlay{background-color:rgba(80,80,80,.6);width:100%;height:100%;z-index:100;position:absolute;left:0;top:0}.tb-container{height:40px;border-style:none;background-color:#2850a7}.row{flex-flow:row}.col-10{width:83%}.col-9{width:75%}.col-6{width:50%}.col-3{width:25%}.col-8{width:67%}.col-4{width:33%}.col-2{width:17%}.container{width:100%}.centered{justify-content:center}.left-aligned{justify-content:left}.card{border-radius:4px;color:#000;width:400px;-webkit-box-shadow:0 1px 7px 0 rgba(0,0,0,.75);-moz-box-shadow:0 1px 7px 0 rgba(0,0,0,.75);box-shadow:0 1px 7px 0 rgba(0,0,0,.75);padding:7px 14px;font-size:81.25%}.btn-outline,.btn-primary{font-weight:500;height:32px;margin:0;padding:6px 16px 8px;text-decoration:none;text-transform:none;cursor:pointer}.card-section{width:100%;border-bottom:1px solid #eee}.btn-primary{background-color:#1a73e8;border:none;border-radius:4px;color:#fff;flex-shrink:0}.btn-primary:hover{-webkit-box-shadow:0 2px 8px 0 rgba(66,137,230,1);-moz-box-shadow:0 2px 8px 0 rgba(66,137,230,1);box-shadow:0 2px 8px 0 rgba(66,137,230,1)}.btn-primary:active{outline-style:none;background-color:#4289e6}.btn-outline{background-color:#fff;border:1px solid #dadce0;border-radius:4px;color:#1a73e8;flex-shrink:0}.btn-outline:hover{background-color:#f8faff}.btn-outline:active{box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 3px 6px 2px rgba(60,64,67,.15)}.txt-underlined{background-color:#f1f3f4;border:none;box-sizing:border-box;color:#202124;font-family:inherit;font-size:inherit;line-height:inherit;outline:0;padding-bottom:8px;padding-inline-end:8px;padding-inline-start:8px;padding-top:6px;text-align:inherit;text-overflow:ellipsis;width:100%;border-radius:3px}.txt-underlined:focus{border-bottom:2px solid #1a73e8}.alert-error{color:red}</style></head><body> <corg-app> </corg-app> <script>var x=null,y=null;document.addEventListener("mousemove",onMouseUpdate,!1);function onMouseUpdate(a){x=a.pageX,y=a.pageY}function getMouseX(){return x}function getMouseY(){return y}function App(){this.init()}App.prototype.init=function(){var a=document.getElementsByTagName("corg-app");1<a.length?console.error("Multiple corg-app roots found!There should be only one root"):(this.root=a[0],this.components=[]),this.events=[],this.postevents=[],this.looptemplates=[],this.ap_elems=[],this.comp_params=[]},App.prototype.reRender=function(){this.root.innerHTML="",this.events=[],this.looptemplates=[],this.ap_elems=[],this.comp_params=[];for(var a=0;a<this.postevents.length;a++)this.postevents[a].action(this.postevents[a].data);this.postevents=[],this.renderComponent("comp-app")},App.prototype.updateApp=function(a,b){var c=[],d=a,e=null;null==b?(b="comp-app",null==d&&(d=this.root,e=this.components[this.components.length-1])):null!=b&&(e=this.components.filter(a=>a.name==b)[0],null==d&&(d=a)),d==this.root?model=this.components.filter(a=>"comp-app"==a.name)[0].model:null!=e&&(model=e.model),null!=e.model.onRefresh&&e.model.onRefresh(e.model),d.childNodes.forEach(a=>{if("function"==typeof a.getAttribute&&null!=a.getAttribute("ap-elem")){var b=parseInt(a.getAttribute("ap-elem").toString());a.parentNode.replaceChild(this.ap_elems[b],a)}}),d.childNodes.forEach(a=>{if("function"==typeof a.getAttribute){if(null!=a.getAttribute("no-show")){var b=a.getAttribute("no-show").toString();if("{"==b[0]&&"}"==b[b.length-1]){b=b.substring(1,b.length-1);var d=a.cloneNode(!0);this.ap_elems.push(d),a.setAttribute("ap-elem",this.ap_elems.length-1),a.setAttribute("no-show",this.iterateStaticModel(e.model,b))}}if(null!=a.getAttribute("no-show")&&"true"==a.getAttribute("no-show")){var f=document.createElement("div");if(null!=a.getAttribute("ap-elem")){var g=parseInt(a.getAttribute("ap-elem").toString());f.setAttribute("ap-elem",g),a.parentNode.replaceChild(f,a)}}if(null!=a.getAttribute("comp"))c.push({element:a,compname:a.getAttribute("comp")});else if(null!=e){var h=this.comp_params.filter(a=>a.comp==e.name)[0];if(null!=h&&(e.model.props[h.param_name]=this.iterateStaticModel(h.model,h.ptr)),this.updateApp(a,e.name),null!=a.getAttribute("in"))data_attrib=a.getAttribute("in"),a.setAttribute("value",this.iterateStaticModel(model,data_attrib)),a.value=this.iterateStaticModel(model,data_attrib);else if(null!=a.getAttribute("out")){data_attrib=a.getAttribute("out");var i=this.iterateStaticModel(e.model,data_attrib);if(!Array.isArray(i)){var j=this.renderTemplate(a.innerHTML,this.iterateStaticModel(e.model,data_attrib));a.innerHTML=j===a.innerHTML?this.iterateStaticModel(e.model,data_attrib):j}else{var k=parseInt(a.getAttribute("ltid")),l=this.looptemplates[k];a.innerHTML="",i.forEach(b=>{var c=l.cloneNode(!0);c.innerHTML=this.renderTemplate(c.innerHTML,b);var d=c.getElementsByTagName("*");d=Array.prototype.slice.call(d),0==d.length?d=[c]:d.push(c),_element=b;for(var f=0;f<d.length;f++)if(null!=d[f].getAttribute("click")){var g=d[f].getAttribute("click");this.events.push({handler:this.iterateStaticModel(e.model,g),data:e.model,my:_element,type:"click"}),d[f].setAttribute("clickevt",this.events.length-1)}a.appendChild(c)})}}}else console.err("Component Updation failed for "+a);c.forEach(a=>{this.updateApp(a.element,a.compname)})}}),null!=e.model.refreshFinished&&e.model.refreshFinished(e.model)},App.prototype.iterateStaticModel=function(a,b){for(var c=b.split(".");1<c.length;)if(c.toString().endsWith("]")){var d=c.toString().split("[")[1];d=d.substring(0,d.length-1),d=parseInt(d),a=a[c.toString().split("[")[0]],a=a[d]}else a=a[c.shift()];if(c.toString().endsWith("]")){var d=c.toString().split("[")[1];return d=d.substring(0,d.length-1),d=parseInt(d),a=a[c.toString().split("[")[0]],a[d]}return a[c.shift()]},App.prototype.updateObject=function(a,b,c){for(var d=c.split(".");1<d.length;)a=a[d.shift()];a[d.shift()]=b},App.prototype.validateComponent=function(a){let b=new DOMHelper;for(var c,d=b.createElementFromHTML(a),e=d.getElementsByTagName("*"),f=0;f<e.length;f++)c=null,null!=e[f].getAttribute("in")&&(c=e[f].getAttribute("in")),null!=e[f].getAttribute("out")&&(c=e[f].getAttribute("out")),null!=e[f].getAttribute("inout")&&(c=e[f].getAttribute("inout"));return!0},App.prototype.addComponent=function(a,b,c,d){this.validateComponent(b,c)?(this.components.push({name:a,html:b,model:c,isRoot:d}),d&&(this.root.innerHTML=b)):console.error("Invalid Component not pushed to app")},App.prototype.renderTemplate=function(a,b){for(var c=!1,d="",e=[],f=0;f<a.length;f++)c?c&&("}"==a.charAt(f)?(c=!1,e.push({text:d,end:f-1,start:f-1-d.length}),d=""):d+=a.charAt(f)):"{"==a.charAt(f)&&(c=!0);for(var f=0;f<e.length;f++)a=a.replace("{"+e[f].text+"}",this.iterateStaticModel(b,e[f].text));return a},App.prototype.renderComponent=function(a){var b=this.components.filter(b=>b.name==a);if(0==b.length)return void console.error("The component "+a+" is not present in the app");b=b[0];var c=new DOMHelper().createElementFromHTML(b.html);b.rendered=c;for(var d=c.getElementsByTagName("*"),e=0;e<d.length;e++){if(null!=d[e].getAttribute("in")&&(data_attrib=d[e].getAttribute("in"),d[e].setAttribute("value",this.iterateStaticModel(b.model,data_attrib)),this.events.push({handler:function(a,b,c){a.update(a.model,c,a.path)},data:{path:data_attrib,model:b.model,update:this.updateObject},my:null,type:"change"}),d[e].setAttribute("changeevt",this.events.length-1)),null!=d[e].getAttribute("out")){data_attrib=d[e].getAttribute("out");var f=this.iterateStaticModel(b.model,data_attrib);if(!Array.isArray(f)){var g=this.renderTemplate(d[e].innerHTML,this.iterateStaticModel(b.model,data_attrib));d[e].innerHTML=g===d[e].innerHTML?this.iterateStaticModel(b.model,data_attrib):g}else{var h=d[e].getElementsByTagName("*"),j=h[0];1<h.length&&(j.inner_html=d[e].inner_html),this.looptemplates.push(j),d[e].setAttribute("ltid",(this.looptemplates.length-1).toString()),d[e].innerHTML="",f.forEach(a=>{var c=j.cloneNode(!0);c.innerHTML=this.renderTemplate(c.innerHTML,a);var f=c.getElementsByTagName("*");0==f.length&&(f=[c]);for(var g=0;g<f.length;g++)if(null!=f[g].getAttribute("click")){var h=f[g].getAttribute("click");this.events.push({handler:this.iterateStaticModel(b.model,h),data:b.model,my:a,type:"click"}),f[g].setAttribute("clickevt",this.events.length-1)}d[e].appendChild(c)})}}if(null!=d[e].getAttribute("inout")&&(data_attrib=d[e].getAttribute("inout")),null!=d[e].getAttribute("click")&&null==d[e].getAttribute("clickevt")){var k=d[e].getAttribute("click");this.events.push({handler:this.iterateStaticModel(b.model,k),data:b.model,my:null,type:"click"}),d[e].setAttribute("clickevt",this.events.length-1)}if(null!=d[e].getAttribute("change")&&null==d[e].getAttribute("changeevt")){var k=d[e].getAttribute("change");this.events.push({handler:this.iterateStaticModel(b.model,k),data:b.model,my:null,type:"change"}),d[e].setAttribute("changeevt",this.events.length-1)}if(null!=d[e].getAttribute("keydown")&&null==d[e].getAttribute("keydownevt")){var k=d[e].getAttribute("keydown");this.events.push({handler:this.iterateStaticModel(b.model,k),data:b.model,my:null,type:"keydown"}),d[e].setAttribute("keydownevt",this.events.length-1)}}var l=c.getElementsByTagName("*");let m=new DOMHelper;for(var e=0;e<l.length;e++)if(0==l[e].tagName.toLowerCase().indexOf("comp-")){var n=this.components.filter(a=>a.name==l[e].tagName.toLowerCase())[0],o=new DOMHelper().getAllAttributes(l[e]);o.forEach(a=>{if(null==n.model.props&&(n.model.props={}),"{"==a.value[0]&&"}"==a.value[a.value.length-1]){var c=a.value.substring(1,a.value.length-1);this.comp_params.push({comp:l[e].tagName.toLowerCase(),model:b.model,ptr:c,param_name:a.name}),n.model.props[a.name]=this.iterateStaticModel(b.model,c)}else n.model.props[a.name]=a.value});var p=m.createElementFromHTML(this.renderComponent(l[e].tagName.toLowerCase()));p.setAttribute("comp",l[e].tagName.toLowerCase()),l[e].parentNode.replaceChild(p,l[e])}if(b.html=c.outerHTML,b.isRoot){var q=this,r=function(a){null!=a.srcElement.getAttribute("clickevt")&&(q.events[parseInt(a.srcElement.getAttribute("clickevt"))].handler(q.events[parseInt(a.srcElement.getAttribute("clickevt"))].data,q.events[parseInt(a.srcElement.getAttribute("clickevt"))].my),q.updateApp())},s=function(a){null!=a.srcElement.getAttribute("changeevt")&&(q.events[parseInt(a.srcElement.getAttribute("changeevt"))].handler(q.events[parseInt(a.srcElement.getAttribute("changeevt"))].data,q.events[parseInt(a.srcElement.getAttribute("changeevt"))].my,a.srcElement.value),document.elementFromPoint(getMouseX(),getMouseY()).click(),q.updateApp())},t=function(a){null!=a.srcElement.getAttribute("keydownevt")&&(q.events[parseInt(a.srcElement.getAttribute("keydownevt"))].handler(q.events[parseInt(a.srcElement.getAttribute("keydownevt"))].data,q.events[parseInt(a.srcElement.getAttribute("keydownevt"))].my,a.srcElement.value),q.updateApp())};this.postevents.push({action:function(a){document.body.removeEventListener("click",a)},data:r}),this.postevents.push({action:function(a){document.body.removeEventListener("change",a)},data:s}),this.postevents.push({action:function(a){document.body.removeEventListener("keydown",a)},data:t}),document.body.addEventListener("click",r),document.body.addEventListener("change",s),document.body.addEventListener("keydown",t),this.root.innerHTML=b.html,this.updateApp()}return b.html};function DOMHelper(){}DOMHelper.prototype.createElementFromHTML=function(a){var b=document.createElement("div");return null==a?null:(b.innerHTML=a.trim(),b.firstChild)},DOMHelper.prototype.getAllAttributes=function(a){for(var b,c=[],d=0,e=a.attributes,f=e.length;d<f;d++)b=e[d],c.push({name:b.nodeName,value:b.nodeValue.toString()});return c};let app=new App;app.addComponent("comp-navbar",`<div> <div class="toolbar"> <div class="row"> <div class="col-3"> </div><div class="col-6"> <div class="tb-container"> <div class="row"> <input class="toolbar-textbox fullwidth" in="searchq" click="clearph" keydown="searchboxKeyDown"/> </div></div></div><div class="col-3"> </div></div></div></div>`,{searchq:"Search Products",clearph:function(a){"Search Products"==a.searchq&&(a.searchq="")},searchboxKeyDown:function(a){console.log(a.searchq)}},!1),app.addComponent("comp-products",`<div> <div class="container centered" style="flex-flow: column;"> <div class="row centered"> <h4>Products</h4> </div><div class="row centered" no-show="{noProducts}"> <div class="card" id="product-list" style="max-height: 300px; overflow-y: auto;"> <div out="products"> <div class="row card-section"> <div class="row"> <p>{name}</p></div><button class="btn-outline" click="handleEditProduct" style="top: 6px; position:relative;">Edit</button> </div></div></div></div><br/><br/> <div class="row centered" no-show="{subtabstate[0]}"> <div class="card" style="max-height: 50px; padding-top: 10px;"> <div class="row"> <div class="col-10"> <input class="txt-underlined" in="productName"/> </div><div class="col-2" style="padding-left: 10px;"> <button class="btn-primary" click="handleAddProduct">Add</button> </div></div></div></div><div class="row centered" no-show="{subtabstate[1]}"> <div class="card" style="max-height: 100px; padding-top: 10px;"> <div class="row card-section" style="padding-bottom: 10px;"> <div style="width: 100%;"> <input class="txt-underlined" in="modProductName"/> </div></div><div class="row card-section" style="padding-top: 10px; padding-bottom: 10px;"> <button class="btn-primary" click="handleModProductName"> Modify </button> <button class="btn-outline" style="margin-left: 10px;" click="handleRemoveProduct"> Remove </button> <button class="btn-outline" style="margin-left: 10px; float: right;" click="handleCancelProductMod">Cancel</button> </div></div></div><div class="row alert-error centered" no-show="{alerts.noErrors}"> <p out="alerts.errMessage"></p></div></div></div>`,{products:[],productName:"",nextProdID:0,modProductName:"",modProductID:-1,alerts:{noErrors:!0,errMessage:""},noProducts:!0,subtabstate:[!1,!0],handleEditProduct:function(a,b){a.modProductName=b.name,a.modProductID=b.id,a.subtabstate=[!0,!1]},handleAddProduct:function(a){return a.alerts={noErrors:!0,errMessage:""},""==a.productName||null==a.productName?void(a.alerts={noErrors:!1,errMessage:"Please enter a valid product Name"}):null==a.products.find(b=>b.name===a.productName)?void(a.products.push({name:a.productName,id:a.nextProdID++}),a.noProducts=!1,a.productName=""):(a.alerts={noErrors:!1,errMessage:"Product Already exists"},void(a.productName=""))},handleModProductName:function(a){var b=a.products.find(b=>{if(b.id===a.modProductID)return b});null!=b&&(b.name=a.modProductName),a.subtabstate=[!1,!0],a.noProducts=0==a.products.length},handleRemoveProduct:function(a){a.products=a.products.filter(b=>{if(b.id!==a.modProductID)return b}),a.subtabstate=[!1,!0],a.noProducts=0==a.products.length},handleCancelProductMod:function(a){a.subtabstate=[!1,!0]}},!1),app.addComponent("comp-tabstrip",`<div style="width: 100%;"> <div no-show="{curTabStat[0]}"> <comp-products></comp-products> </div><div no-show="{curTabStat[1]}"> Tab </div></div>`,{curTabStat:[],onRefresh:function(a){a.curTabStat=a.props.tabstat}},!1),app.addComponent("comp-app",`<div> <div class="sidenav-overlay faceIn" id="sidenav-overlay" no-show="{hideSideNav}" click="closeSideNav"> </div><div class="sidenav" no-show="{hideSideNav}"> <div class="sidenav-item" click="changeTab">Item 1</div><div class="sidenav-item">Item 2</div></div><comp-navbar searchq="{searchq}"></comp-navbar> <div class="container" style="top: 60px; position:relative;"> <comp-tabstrip tabstat="{tabStat}"></comp-tabstrip> </div></div>`,{tabStat:[!1,!0],tabTo:1,hideSideNav:!0,searchq:"",changeTab:function(a){a.showSideNav(a);for(var b=0;b<a.tabStat.length;b++)a.tabStat[b]=b!=a.tabTo},showSideNav:function(a){a.hideSideNav=!1},closeSideNav:function(a){a.hideSideNav=!0}},!0),app.renderComponent("comp-app"); </script></body></html>
